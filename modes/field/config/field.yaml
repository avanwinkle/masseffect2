#config_version=5

#####
# MASS EFFECT 2: FIELD MODE
#
# This is the "open playfield" mode that runs whenever there is no Mission mode
# or Wizard mode active. It contains many of the show materials (lights, sounds)
# for the Global modes that are disabled during missions.
#####

mode:
  start_events: start_mode_field
  stop_events: stop_mode_field
  priority: 310

event_player:
  mode_field_started.1:
    set_environment:
      env: field
  # If we are returning to field because we failed the suicide mission, say so
  mode_field_started.2{device.achievements.suicidemission.state=="stopped"}:
    - reset_from_suicide
    # Looking for other mode_field_started events? Check the field submode configs!
  mode_field_started.3:
    show_base_slide:
      is_available:
        value: current_player.available_missions>0
        type: bool
      is_resume:
        value: current_player.resume_mission!=" "
        type: bool
      is_multiplayer:
        value: game.num_players>1
        type: bool
  # Route this event through event_player to avoid playing while field is inactive
  music_intro_stopped: play_galaxy_map

config:
  - field_bumpers.yaml
  - field_recruit.yaml
  - field_shadowbroker.yaml
  - field_shopping.yaml

playlists:
  field_music:
    repeat: true
    sounds:
      - music_normandy_walkin_intro
      - music_galaxy_map

playlist_player:
  mode_field_started:
    field_music_track:
      action: play
      playlist: field_music
      crossfade_time: 1s

sounds:
  music_normandy_walkin_intro:
    file: mus_nor_normandy_walkin_intro.ogg
    track: music
  music_galaxy_map:
    file: mus_galaxy_map_loop.ogg
    track: music

slide_player:
  reset_from_suicide:
    reset_from_suicide_slide:
      action: play
      expire: 5s
  show_base_slide:
    singleplayer_slide{not is_multiplayer}:
      action: play
      priority: 1
    multiplayer_slide{is_multiplayer}:
      action: play
      priority: 2
  show_multiplayer_slide:
    multiplayer_slide:
      action: play
    singleplayer_slide:
      action: remove
  disable_missionresume:
    resume_slide:
      action: remove
  mode_field_will_stop:
    singleplayer_slide:
      action: remove
    multiplayer_slide:
      action: remove

slides:
  reset_from_suicide_slide:
    widgets:
      - type: text
        text: the Suicide Mission
        color: BBBBBB
        style: body_sm
        anchor_y: top
        y: top-2
      - type: text
        text: FAILED
        style: text_default
        y: middle+2
      - type: text
        text: You must recruit
        style: body_md
        anchor_y: bottom
        y: 8
      - type: text
        text: your team again
        style: body_md
        anchor_y: bottom
        y: 1
