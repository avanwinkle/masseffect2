#config_version=5

#####
# RECRUIT FIELD MODE
#
# This mode is the "generic" gameplay experience, i.e. what's happening when no
# other mode is active. It's got logic for lighting all the recruitment mission
# shots and tracking the hit counts for each of them.
#
# For now, it also has responsibility for the N7 Assignments counter and mode
# start logic, because we will only want to start N7 Assignments when we're
# in Recruit Field mode (i.e. never during any other mode)
#####
event_player:
  mode_field_started: enable_recruit_shots, disable_fullorbit
  mode_field_will_stop: disable_recruit_shots, enable_fullorbit
  logicblock_n7_hits_counter_complete: start_mode_n7_assignments
  # When a squadmate moves from "shot" to "lit", re-evaluate the shots
  recruit_lit: enable_recruit_shots

counters:
  n7_hits_counter:
    starting_count: 40
    count_complete_value: 0
    direction: down
    count_events: n7_advance_shot_hit
    disable_on_complete: false
    reset_on_complete: true
    persist_state: true

shot_profiles:
  recruit_shot_profile:
    show_when_disabled: false
    show: color_on
    states:
      - name: active

shots:
  n7_advance_shot:
    switches: s_bumper_bottom, s_bumper_right, s_bumper_left
    enable_events: enable_recruit_shots
    disable_events: disable_recruit_shots
  recruit_garrus_shot:
    hit_events: sh_left_ramp_hit
    profile: recruit_shot_profile
    enable_events:
      - enable_recruit_shots{current_player.status_garrus<3}
    disable_events:
      - disable_recruit_shots
      - recruit_lit{squadmate=="garrus"}
    show_tokens:
      leds: shot_shield_garrus
      color: 0E1B4F #color_garrus
  recruit_grunt_shot:
    hit_events: sh_left_orbit_hit
    profile: recruit_shot_profile
    enable_events:
      - enable_recruit_shots{current_player.status_grunt<3}
    disable_events:
      - disable_recruit_shots
      - recruit_lit{squadmate=="grunt"}
    show_tokens:
      leds: shot_shield_grunt
      color: ED3A00 #color_grunt
  recruit_jack_shot:
    hit_events: sh_kickback_hit
    profile: recruit_shot_profile
    enable_events:
      - enable_recruit_shots{current_player.status_jack<3}
    disable_events:
      - disable_recruit_shots
      - recruit_lit{squadmate=="jack"}
    show_tokens:
      leds: shot_shield_jack
      color: 6F00FF #color_jack
  recruit_kasumi_shot:
    hit_events: sh_right_ramp_hit
    profile: recruit_shot_profile
    enable_events:
      - enable_recruit_shots{current_player.status_kasumi<3}
    disable_events:
      - disable_recruit_shots
      - recruit_lit{squadmate=="kasumi"}
    show_tokens:
      leds: shot_shield_kasumi
      color: F7F315 #color_kasumi
  recruit_legion_shot:
    hit_events: sh_kickback_hit
    profile: recruit_shot_profile
    enable_events:
      - enable_recruit_shots{current_player.status_jack>3 and current_player.status_legion<3}
    disable_events:
      - disable_recruit_shots
      - recruit_lit{squadmate=="jack"}
    show_tokens:
      leds: shot_shield_legion
      color: FFFFFF #color_legion
  recruit_mordin_shot:
    hit_events: sh_right_orbit_hit
    profile: recruit_shot_profile
    enable_events:
      - enable_recruit_shots{current_player.status_mordin<3}
    disable_events:
      - disable_recruit_shots
      - recruit_lit{squadmate=="mordin"}
    show_tokens:
      leds: shot_shield_mordin
      color: BD000A #color_mordin
  recruit_samara_shot:
    hit_events: sh_left_ramp_hit
    profile: recruit_shot_profile
    enable_events:
      - enable_recruit_shots{current_player.status_garrus>3 and current_player.status_samara<3}
    disable_events:
      - disable_recruit_shots
      - recruit_lit{squadmate=="garrus"}
    show_tokens:
      leds: shot_shield_samara
      color: 0037FF #color_samara
  recruit_tali_shot:
    hit_events: sh_right_orbit_hit
    profile: recruit_shot_profile
    enable_events:
      - enable_recruit_shots{current_player.status_mordin>3 and current_player.status_tali<3}
    disable_events:
      - disable_recruit_shots
      - recruit_lit{squadmate=="mordin"}
    show_tokens:
      leds: shot_shield_tali
      color: D323FF #color_tali
  recruit_thane_shot:
    hit_events: sh_right_ramp_hit
    profile: recruit_shot_profile
    enable_events:
      - enable_recruit_shots{current_player.status_kasumi>3 and current_player.status_thane<3}
    disable_events:
      - disable_recruit_shots
      - recruit_lit{squadmate=="kasumi"}
    show_tokens:
      leds: shot_shield_thane
      lit: color_shield_green
      color: 00FF00 #color_thane
  recruit_zaeed_shot:
    hit_events: sh_left_orbit_hit
    profile: recruit_shot_profile
    enable_events:
      - enable_recruit_shots{current_player.status_grunt>3 and current_player.status_zaeed<3}
    disable_events:
      - disable_recruit_shots
      - recruit_lit{squadmate=="grunt"}
    show_tokens:
      leds: shot_shield_zaeed
      color: FF0000 #color_zaeed

sound_player:
  mode_recruitfield_started:
    music_normandy_walkin_intro:
      action: play
      loops: 0
      mode_end_action: stop
      events_when_stopped: play_galaxy_map
  play_galaxy_map:
    music_galaxy_map:
      action: play
      loops: -1 # TODO: integrate with scanning loop
      mode_end_action: stop
  recruit_advance_garrus:
    shot_hit_sounds_garrus:
      action: play
      max_queue_time: 1s
  recruit_advance_grunt:
    shot_hit_sounds_grunt:
      action: play
      max_queue_time: 1s
  recruit_advance_jack:
    shot_hit_sounds_jack:
      action: play
      max_queue_time: 1s
  recruit_advance_kasumi:
    shot_hit_sounds_kasumi:
      action: play
      max_queue_time: 1s
  recruit_advance_legion:
    shot_hit_sounds_legion:
      action: play
      max_queue_time: 1s
  recruit_advance_mordin:
    shot_hit_sounds_mordin:
      action: play
      max_queue_time: 1s
  recruit_advance_samara:
    shot_hit_sounds_samara:
      action: play
      max_queue_time: 1s
  recruit_advance_tali:
    shot_hit_sounds_tali:
      action: play
      max_queue_time: 1s
  recruit_advance_thane:
    shot_hit_sounds_thane:
      action: play
      max_queue_time: 1s
  recruit_advance_zaeed:
    shot_hit_sounds_zaeed:
      action: play
      max_queue_time: 1s

sound_pools:
  shot_hit_sounds_garrus:
    type: random_force_all
    sounds: garrus_shot_sound_1, garrus_shot_sound_2, garrus_shot_sound_3
    track: voice
  shot_hit_sounds_grunt:
    type: random_force_all
    sounds: grunt_shot_sound_1, grunt_shot_sound_2, grunt_shot_sound_3, grunt_shot_sound_4, grunt_shot_sound_5
    track: voice
  shot_hit_sounds_jack:
    type: random_force_all
    sounds: jack_shot_sound_1, jack_shot_sound_2, jack_shot_sound_3, jack_shot_sound_4, jack_shot_sound_5
    track: voice
  shot_hit_sounds_kasumi:
    type: random_force_all
    sounds: kasumi_shot_sound_1, kasumi_shot_sound_2, kasumi_shot_sound_3, kasumi_shot_sound_4, kasumi_shot_sound_5, kasumi_shot_sound_6
    track: voice
  shot_hit_sounds_legion:
    type: random_force_all
    sounds: legion_shot_sound_1, legion_shot_sound_2, legion_shot_sound_3, legion_shot_sound_4, legion_shot_sound_5
    track: voice
  shot_hit_sounds_mordin:
    type: random_force_all
    sounds: mordin_shot_sound_1, mordin_shot_sound_2, mordin_shot_sound_3, mordin_shot_sound_4, mordin_shot_sound_5
    track: voice
  shot_hit_sounds_samara:
    type: random_force_all
    sounds: samara_shot_sound_1, samara_shot_sound_2, samara_shot_sound_3, samara_shot_sound_4, samara_shot_sound_5
    track: voice
  shot_hit_sounds_tali:
    type: random_force_all
    sounds: tali_shot_sound_1, tali_shot_sound_2, tali_shot_sound_3, tali_shot_sound_4
    track: voice
  shot_hit_sounds_thane:
    type: random_force_all
    sounds: thane_shot_sound_1, thane_shot_sound_2, thane_shot_sound_3, thane_shot_sound_4, thane_shot_sound_5
    track: voice
  shot_hit_sounds_zaeed:
    type: random_force_all
    sounds: zaeed_shot_sound_1, zaeed_shot_sound_2, zaeed_shot_sound_3, zaeed_shot_sound_4, zaeed_shot_sound_5, zaeed_shot_sound_6
    track: voice

sounds:
  music_normandy_walkin_intro:
    file: mus_nor_normandy_walkin_intro.ogg
    track: music
  music_galaxy_map:
    file: mus_galaxy_map_loop.ogg
    track: music
  garrus_shot_sound_1:
    file: en_us_hench_garrus_ss_global_hench_garrus_00303204_m.ogg
    track: voice
  garrus_shot_sound_2:
    file: en_us_hench_garrus_ss_global_hench_garrus_00330893_m.ogg
    track: voice
  garrus_shot_sound_3:
    file: en_us_hench_garrus_ss_global_hench_garrus_00330906_m.ogg
    track: voice
  grunt_shot_sound_1:
    file: en_us_hench_grunt_ss_global_hench_grunt_00316600_m.ogg
    track: voice
  grunt_shot_sound_2:
    file: en_us_hench_grunt_ss_global_hench_grunt_00317212_m.ogg
    track: voice
  grunt_shot_sound_3:
    file: en_us_hench_grunt_ss_global_hench_grunt_00331036_m.ogg
    track: voice
  grunt_shot_sound_4:
    file: en_us_hench_grunt_ss_global_hench_grunt_00331040_m.ogg
    track: voice
  grunt_shot_sound_5:
    file: en_us_hench_grunt_ss_global_hench_grunt_00295739_m.ogg
    track: voice
  jack_shot_sound_1:
    file: en_us_hench_convict_ss_global_hench_convict_00286790_m.ogg
    track: voice
  jack_shot_sound_2:
    file: en_us_hench_convict_ss_global_hench_convict_00286854_m.ogg
    track: voice
  jack_shot_sound_3:
    file: en_us_hench_convict_ss_global_hench_convict_00286835_m.ogg
    track: voice
  jack_shot_sound_4:
    file: en_us_hench_convict_ss_global_hench_convict_00286855_m.ogg
    track: voice
  jack_shot_sound_5:
    file: en_us_hench_convict_ss_global_hench_convict_00286853_m.ogg
    track: voice
  kasumi_shot_sound_1:
    file: DLC_HEN_MT_Int.096.ogg
    track: voice
  kasumi_shot_sound_2:
    file: DLC_HEN_MT_Int.117.ogg
    track: voice
  kasumi_shot_sound_3:
    file: DLC_HEN_MT_Int.146.ogg
    track: voice
  kasumi_shot_sound_4:
    file: DLC_HEN_MT_Int.155.ogg
    track: voice
  kasumi_shot_sound_5:
    file: DLC_HEN_MT_Int.159.ogg
    track: voice
  kasumi_shot_sound_6:
    file: DLC_HEN_MT_Int.221.ogg
    track: voice
  legion_shot_sound_1:
    file: en_us_hench_geth_ss_global_hench_geth_00240681_m.ogg
    track: voice
  legion_shot_sound_2:
    file: en_us_hench_geth_ss_global_hench_geth_00240710_m.ogg
    track: voice
  legion_shot_sound_3:
    file: en_us_hench_geth_ss_global_hench_geth_00242502_m.ogg
    track: voice
  legion_shot_sound_4:
    file: en_us_hench_geth_ss_global_hench_geth_00315331_m.ogg
    track: voice
  legion_shot_sound_5:
    file: en_us_hench_geth_ss_global_hench_geth_00315345_m.ogg
    track: voice
  mordin_shot_sound_1:
    file: en_us_hench_professor_ss_global_hench_professor_00316910_m.ogg
    track: voice
  mordin_shot_sound_2:
    file: en_us_hench_professor_ss_global_hench_professor_00316952_m.ogg
    track: voice
  mordin_shot_sound_3:
    file: en_us_hench_professor_ss_global_hench_professor_00316963_m.ogg
    track: voice
  mordin_shot_sound_4:
    file: en_us_hench_professor_ss_global_hench_professor_00316964_m.ogg
    track: voice
  mordin_shot_sound_5:
    file: en_us_hench_professor_ss_global_hench_professor_00331211_m.ogg
    track: voice
  samara_shot_sound_1:
    file: en_us_hench_mystic_ss_global_hench_mystic_00316732_m.ogg
    track: voice
  samara_shot_sound_2:
    file: en_us_hench_mystic_ss_global_hench_mystic_00331131_m.ogg
    track: voice
  samara_shot_sound_3:
    file: en_us_hench_mystic_ss_global_hench_mystic_00331153_m.ogg
    track: voice
  samara_shot_sound_4:
    file: en_us_hench_mystic_ss_global_hench_mystic_00331158_m.ogg
    track: voice
  samara_shot_sound_5:
    file: en_us_hench_mystic_ss_global_hench_mystic_00331164_m.ogg
    track: voice
  tali_shot_sound_1:
    file: en_us_hench_tali_ss_global_hench_tali_00285102_m.ogg
    track: voice
  tali_shot_sound_2:
    file: en_us_hench_tali_ss_global_hench_tali_00285168_m.ogg
    track: voice
  tali_shot_sound_3:
    file: en_us_hench_tali_ss_global_hench_tali_00289284_m.ogg
    track: voice
  tali_shot_sound_4:
    file: en_us_hench_tali_ss_global_hench_tali_00289285_m.ogg
    track: voice
  thane_shot_sound_1:
    file: en_us_hench_assassin_ss_global_hench_assassin_00286433_m.ogg
    track: voice
  thane_shot_sound_2:
    file: en_us_hench_assassin_ss_global_hench_assassin_00297586_m.ogg
    track: voice
  thane_shot_sound_3:
    file: en_us_hench_assassin_ss_global_hench_assassin_00316486_m.ogg
    track: voice
  thane_shot_sound_4:
    file: en_us_hench_assassin_ss_global_hench_assassin_00330846_m.ogg
    track: voice
  thane_shot_sound_5:
    file: en_us_hench_assassin_ss_global_hench_assassin_00286432_m.ogg
    track: voice
  zaeed_shot_sound_1:
    file: DLC_HEN_VT_Int.002.ogg
    track: voice
  zaeed_shot_sound_2:
    file: DLC_HEN_VT_Int.007.ogg
    track: voice
  zaeed_shot_sound_3:
    file: DLC_HEN_VT_Int.020.ogg
    track: voice
  zaeed_shot_sound_4:
    file: DLC_HEN_VT_Int.030.ogg
    track: voice
  zaeed_shot_sound_5:
    file: DLC_HEN_VT_Int.060.ogg
    track: voice
  zaeed_shot_sound_6:
    file: DLC_HEN_VT_Int.116.ogg
    track: voice

widget_player:
  logicblock_n7_hits_counter_hit:
    n7_progress_widget:
      action: update
      widget_settings:
        expire: 2s

widgets:
  n7_progress_widget:
    - type: text
      text: "N7 assignment in (count)"
      style: dmd_small
      anchor_y: bottom
      anchor_x: left
      y: 2
      x: 2
      z: 2
    - type: rectangle
      width: 128
      height: 8
      color: 000000
      anchor_y: bottom
      anchor_x: left
      x: 0
      y: 0
      z: 1
