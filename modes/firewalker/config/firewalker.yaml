#config_version=5

#####
# FIREWALKER MODE
#
# This mode is the base for the Firewalker missions. All the missions
# share the same shots with shows and very similar behavior. This base
# mode defines those shots, and uses custom code for the exact gameplay
# rules based on the player's progress.
#
# Each mode lights shots at red, and uses the red -> orange -> green progression
# to collect research packets and complete the mode. As the modes advance,
# the rules change to increase difficulty. Hitting any green shot will complete
# the mode (except for the final multiball).
#
# ROSALIE:          All shots are lit. Hitting any shot advances all shots.
# VOLCANO STATION:  All shots are lit. Hitting any shot disables _that_ shot
#                   and advances the rest.
# GETH INCURSION:   All shots are lit. Hitting any shot advances _that_ shot.
# SURVEY SITES:     All shots are lit. Hitting any shot advances _that_ shot
#                   and resets all the rest.
# PROTHEAN SITE:    A special multiball! Gets its own mode.
#####

mode:
  start_events: start_mode_firewalker
  stop_events: stop_mode_firewalker, firewalker_mission_complete, firewalker_mission_failed, stop_wizards
  events_when_started: mode_type_wizard_started
  events_when_stopped: mode_type_wizard_stopped
  code: firewalker.Firewalker
  priority: 1000

event_player:
  firewalker_shots_green_hit: firewalker_mission_complete
  timer_fwtimer_complete: firewalker_mission_failed

variable_player:
  # After a mission, mark the shot as complete or reset it
  firewalker_mission_complete.10:
    fwps_lo{current_player.fwps_lo==1}: 1
    fwps_kb{current_player.fwps_kb==1}: 1
    fwps_lr{current_player.fwps_lr==1}: 1
    fwps_rr{current_player.fwps_rr==1}: 1
    fwps_ro{current_player.fwps_ro==1}: 1
  # If the mission fails, drains, whatever, drop the shot back to zero
  mode_firewalker_will_stop:
    fwps_lo{current_player.fwps_lo==1}: -1
    fwps_kb{current_player.fwps_kb==1}: -1
    fwps_lr{current_player.fwps_lr==1}: -1
    fwps_rr{current_player.fwps_rr==1}: -1
    fwps_ro{current_player.fwps_ro==1}: -1

timers:
  fwtimer:
    start_value: 20
    end_value: 0
    tick_interval: 1s
    direction: down
    control_events:
      - event: firewalker_shots_hit
        action: restart

shot_groups:
  firewalker_shots:
    shots: firewalker_left_orbit, firewalker_kickback, firewalker_left_ramp, firewalker_right_ramp, firewalker_right_orbit

shots:
  firewalker_left_orbit:
    hit_events: sh_left_orbit_hit
    profile: firewalker_profile
    show_tokens:
      leds: l_left_orbit_ring
  firewalker_kickback:
    hit_events: sh_kickback_hit
    profile: firewalker_profile
    show_tokens:
      leds: l_kickback_ring
  firewalker_left_ramp:
    hit_events: sh_left_ramp_hit
    profile: firewalker_profile
    show_tokens:
      leds: l_left_ramp_ring
  firewalker_right_ramp:
    hit_events: sh_right_ramp_hit
    profile: firewalker_profile
    show_tokens:
      leds: l_right_ramp_ring
  firewalker_right_orbit:
    hit_events: sh_right_orbit_hit
    profile: firewalker_profile
    show_tokens:
      leds: l_right_orbit_ring

shot_profiles:
  firewalker_profile:
    advance_on_hit: false
    show_when_disabled: false
    states:
      - name: red
        show: led_6_chase_duo
        show_tokens:
          speed: 12
          color: color_door_red
          fade: 50ms
      - name: orange
        show: led_6_chase_duo
        show_tokens:
          speed: 12
          color: color_door_orange
          fade: 50ms
      - name: green
        show: led_6_chase_duo
        show_tokens:
          speed: 12
          color: color_door_green
          fade: 50ms
