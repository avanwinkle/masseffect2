#config_version=5

# Relay through event_player because widget_player doesn't like conditions/priorities
event_player:
  player_added:
    # Give a small delay to allow the player vars to initialize, lest the placeholder text show goofy
    - add_player_2{num==2}|150ms
    - add_player_3{num==3}|150ms
    - remove_level{num==3 and not is_lcd}|150ms
    - add_player_4{num==4}|150ms
    - remove_ball{num==3 and not is_lcd}|150ms
  player_turn_started{game.num_players>1}:
    - multiplayer_turn_start_1{number==1}
    - multiplayer_turn_start_2{number==2}
    - multiplayer_turn_start_3{number==3}
    - multiplayer_turn_start_4{number==4}
  player_turn_ended{game.num_players>1}:
    - multiplayer_turn_end_1{number==1}
    - multiplayer_turn_end_2{number==2}
    - multiplayer_turn_end_3{number==3}
    - multiplayer_turn_end_4{number==4}
  # If a second player joins during player1's turn, swap singleplayer_slide for multiplayer_slide
  multiplayer_game{mode["field"].active and not mode["field"].stopping}: show_multiplayer_slide

slide_player:
  show_base_slide:
    singleplayer_slide{not is_multiplayer}:
      action: play
      target: lcd_left
      priority: 1
    multiplayer_slide{is_multiplayer}:
      action: play
      target: lcd_left
      priority: 2
  show_multiplayer_slide:
    multiplayer_slide:
      action: play
      target: lcd_left
    singleplayer_slide:
      action: remove
  disable_missionresume:
    resume_slide:
      action: remove
  ball_will_end:
    singleplayer_slide:
      action: remove
    multiplayer_slide:
      action: remove

widget_player:
  # First event, before additional players have a chance to enter
  game_started:
    base_level_widget:
      slide: singleplayer_slide
    base_ball_widget:
      slide: singleplayer_slide
  show_base_slide{is_available and not is_resume}:
    introslide_missions:
      slide: field_rightslide_base
      widget_settings:
        expire: 6s
  show_base_slide{not is_available and not is_resume}:
    introslide_no_missions:
      slide: field_rightslide_base
      widget_settings:
        expire: 6s
  # Base starts, show a resume mission?
  show_base_slide{is_resume and not is_multiplayer}:
    resume_widget:
      action: add
      # target: dmd
      priority: 3
    resume_bg_widget:
      action: add
      # target: dmd
      widget_settings:
        height: 17
  show_base_slide{is_resume and is_multiplayer}:
    resume_widget:
      action: add
      # target: dmd
      priority: 3
    resume_bg_widget:
      action: add
      # target: dmd
      widget_settings:
        height: 14
  disable_missionresume:
    resume_widget:
      action: remove
    resume_bg_widget:
      action: remove
  # Player 2 has entered the game, add widgets for player1 and player2
  add_player_2:
    base_level_widget:
      slide: multiplayer_slide
    base_ball_widget:
      slide: multiplayer_slide
    # Start with player1 name, player2 score
    mp_name_widget_player_1:
      slide: multiplayer_slide
    mp_score_widget_player_2:
      slide: multiplayer_slide
  # Player 3 has entered the game
  add_player_3:
    mp_score_widget_player_3:
      slide: multiplayer_slide
  remove_level:
    # Remove the "Level" widget and place the player3 score
    base_level_widget:
      action: remove
  # Player 4 has entered the game
  add_player_4:
    mp_score_widget_player_4:
      slide: multiplayer_slide
  remove_ball:
    # Remove the "Ball" widget and place the player4 score
    base_ball_widget:
      action: remove
  # Player Turns: Swap scores -> names when turn starts, revert when turn ends
  multiplayer_turn_start_1:
    mp_score_widget_player_1:
      action: remove
    mp_name_widget_player_1:
      slide: multiplayer_slide
  multiplayer_turn_end_1:
    mp_score_widget_player_1:
      slide: multiplayer_slide
    mp_name_widget_player_1:
      action: remove
  multiplayer_turn_start_2:
    mp_score_widget_player_2:
      action: remove
    mp_name_widget_player_2:
      action: add
      slide: multiplayer_slide
  multiplayer_turn_end_2:
    mp_score_widget_player_2:
      action: add
      slide: multiplayer_slide
    mp_name_widget_player_2:
      action: remove
  multiplayer_turn_start_3:
    mp_score_widget_player_3:
      action: remove
    mp_name_widget_player_3:
      action: add
      slide: multiplayer_slide
  multiplayer_turn_end_3:
    mp_score_widget_player_3:
      action: add
      slide: multiplayer_slide
    mp_name_widget_player_3:
      action: remove
  multiplayer_turn_start_4:
    mp_score_widget_player_4:
      action: remove
    mp_name_widget_player_4:
      action: add
      slide: multiplayer_slide
  multiplayer_turn_end_4:
    mp_score_widget_player_4:
      action: add
      slide: multiplayer_slide
    mp_name_widget_player_4:
      action: remove

widgets:
  introslide_no_missions:
    - type: text
      text: Build Your Team
      style: header_popup
      animations:
        add_to_slide: popup_enter_animation
    - type: text
      text: "Hit any lane 3x\nto unlock missions"
      style: body_popup
      animations:
        add_to_slide: popup_enter_animation
    - widget: popup_right
  introslide_missions:
    - type: text
      text: Build Your Team
      style: header_popup
      animations:
        add_to_slide: popup_enter_animation
    - type: text
      text: "Select a mission at\nthe Galaxy Map"
      style: body_popup
      animations:
        add_to_slide: popup_enter_animation
    - widget: popup_right
  base_level_widget:
    - type: text
      text: LVL (player|level)
      style: body_sm, row_gutter, col_left_center
  base_ball_widget:
    - type: text
      text: BALL (ball)
      style: body_sm, row_gutter, col_right_indent
  mp_score_widget_player_1:
    - type: text
      text: (player1|score)
      style: body_sm, row_top, col_left_anchor, num
  mp_score_widget_player_2:
    - type: text
      text: (player2|score)
      style: body_sm, row_top, col_right_anchor, num
  mp_score_widget_player_3:
    - type: text
      text: (player3|score)
      style: body_sm, row_bottom, col_left_anchor, num
  mp_score_widget_player_4:
    - type: text
      text: (player4|score)
      style: body_sm, row_bottom, col_right_anchor, num
  mp_name_widget_player_1:
    - type: text
      text: (machine|current_career_player_1)
      style: body_sm, row_top, col_left_anchor
  mp_name_widget_player_2:
    - type: text
      text: (machine|current_career_player_2)
      style: body_sm, row_top, col_right_anchor
  mp_name_widget_player_3:
    - type: text
      text: (machine|current_career_player_3)
      style: body_sm, row_bottom, col_left_anchor
  mp_name_widget_player_4:
    - type: text
      text: (machine|current_career_player_4)
      style: body_sm, row_bottom, col_right_anchor
  resume_widget:
    - type: text
      text: Press action button to
      style: body_md
      y: middle+3
      z: 5
      animations:
        add_to_slide: pulse_text_slow
    - type: text
      text: resume (player|resume_mission) recruitment
      style: body_md
      y: middle-3
      z: 5
      animations:
        add_to_slide: pulse_text_slow
  resume_bg_widget:
    - type: rectangle
      color: 000000
      anchor_y: bottom
      y: middle-6
      height: 14
      width: 128
      z: 4

sound_player:
  player_added{num==1}: gui_splashstart
  play_squadmate_add_garrus: squadmate_add_garrus
  play_squadmate_add_grunt: squadmate_add_grunt
  play_squadmate_add_jack: squadmate_add_jack
  play_squadmate_add_tali: squadmate_add_tali

random_event_player:
  player_added{num>1}:
    force_all: true
    scope: machine
    events:
      - play_squadmate_add_garrus
      - play_squadmate_add_grunt
      - play_squadmate_add_jack
      - play_squadmate_add_tali

sound_pools:
  squadmate_add_garrus:
    track: voice
    type: random
    sounds:
      - garrus_affirmative
      - garrus_you_got_it
      - garrus_im_with_you
      - garrus_lets_try_this
      - garrus_back_in_the_game
  squadmate_add_grunt:
    track: voice
    type: random
    sounds:
      - grunt_im_here_1
      - grunt_yeah_yeah
      - grunt_im_here_2
      - grunt_shotgun_ready
      - grunt_one_more
      - grunt_im_back
  squadmate_add_jack:
    track: voice
    type: random
    sounds:
      - jack_nice
      - jack_want_some_more
      - jack_yeah
      - jack_on_my_way
      - jack_im_back
      - jack_ready_to_roll
  squadmate_add_tali:
    track: voice
    type: random
    sounds:
      - tali_im_here
      - tali_with_you_shepard
      - tali_weapons_ready
      - tali_ready_to_help

sounds:
  gui_splashstart:
    file: sfxgame.Wwise_Generic_GUI.gui_splashstart.ogg
    track: sfx
    volume: 0.5
  garrus_affirmative:
    file: en_us_hench_garrus_ss_global_hench_garrus_00303024_m.ogg # "Affirmative"
    track: voice
  garrus_you_got_it:
    file: en_us_hench_garrus_ss_global_hench_garrus_00303025_m.ogg # "You got it"
    track: voice
  garrus_im_with_you:
    file: en_us_hench_garrus_ss_global_hench_garrus_00303032_m.ogg # "I'm with you"
    track: voice
  garrus_its_the_two_of_us:
    file: en_us_hench_garrus_ss_global_hench_garrus_00303101_m.ogg # "Its the two of us"
    track: voice
  garrus_lets_try_this:
    file: en_us_hench_garrus_ss_global_hench_garrus_00303208_m.ogg # "Let's try this"
    track: voice
  garrus_back_in_the_game:
    file: en_us_hench_garrus_ss_global_hench_garrus_00314420_m.ogg # "Back in the game"
    track: voice
  grunt_im_here_1:
    file: en_us_hench_grunt_ss_global_hench_grunt_00295701_m.ogg # "I'm here"
    track: voice
  grunt_yeah_yeah:
    file: en_us_hench_grunt_ss_global_hench_grunt_00295704_m.ogg # "Yeah yeah"
    track: voice
  grunt_im_here_2:
    file: en_us_hench_grunt_ss_global_hench_grunt_00295709_m.ogg # "I'm here"
    track: voice
  grunt_shotgun_ready:
    file: en_us_hench_grunt_ss_global_hench_grunt_00295719_m.ogg # "Shotgun ready"
    track: voice
  grunt_one_more:
    file: en_us_hench_grunt_ss_global_hench_grunt_00295883_m.ogg # "One more"
    track: voice
  grunt_im_back:
    file: en_us_hench_grunt_ss_global_hench_grunt_00317208_m.ogg # "I'm back!"
    track: voice
  jack_nice:
    file: en_us_hench_convict_ss_global_hench_convict_00296186_m.ogg # "Nice"
    track: voice
  jack_want_some_more:
    file: en_us_hench_convict_ss_global_hench_convict_00296189_m.ogg # "Want some more?"
    track: voice
  jack_yeah:
    file: en_us_hench_convict_ss_global_hench_convict_00296196_m.ogg # "Yeah"
    track: voice
  jack_on_my_way:
    file: en_us_hench_convict_ss_global_hench_convict_00296332_m.ogg # "On my way"
    track: voice
  jack_im_back:
    file: en_us_hench_convict_ss_global_hench_convict_00316548_m.ogg # "I'm back"
    track: voice
  jack_ready_to_roll:
    file: en_us_hench_convict_ss_global_hench_convict_00316552_m.ogg # "Ready to roll"
    track: voice
  tali_im_here:
    file: en_us_hench_tali_ss_global_hench_tali_00285145_m.ogg # "I'm here"
    track: voice
  tali_with_you_shepard:
    file: en_us_hench_tali_ss_global_hench_tali_00285147_m.ogg # "With you Shepard"
    track: voice
  tali_weapons_ready:
    file: en_us_hench_tali_ss_global_hench_tali_00285167_m.ogg # "Weapons ready"
    track: voice
  tali_ready_to_help:
    file: en_us_hench_tali_ss_global_hench_tali_00314434_m.ogg # "Ready to help"
    track: voice
