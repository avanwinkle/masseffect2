#config_version=5

#####
# RESEARCH UPGRADES MODE
#
# This is a mostly passive mode that enables a bonus shot every time a mission
# is completed. Hitting the shot awards big points! That's about all there is
# to it.
#####
event_player:
  collect_research_shot_hit:
    - shipupgrade_completed{current_player.available_shipupgrades>0}
    - research_completed{current_player.available_shipupgrades==0}
  capture_shipupgrade_shot_hit: shipupgrade_completed

variable_player:
  shipupgrade_completed:
    available_shipupgrades: -1
    score: 4000
    # We can't collect both a ship upgrade _and_ research for a levelup
    available_research:
      action: set
      int: 0
  research_completed:
    research_completed: 1
    score: 1000 * (1 + 0.25 * current_player.research_completed)
    # Research upgrades can't be stacked, collecting one resets to zero
    available_research:
      action: set
      int: 0
  # Completing _any_ recruit mission sets a research project available
  recruit_success.1:
    available_research: 1
  # Each squadmate enables a specific research project (meaningless distinctions)
  recruit_success_garrus:
    current_research:
      action: set
      string: "Omni-Tool Damage"
  recruit_success_grunt:
    current_research:
      action: set
      string: "Shotgun Damage"
  recruit_success_jack:
    current_research:
      action: set
      string: "Bio-Amp Interface"
  recruit_success_kasumi:
    current_research:
      action: set
      string: "M22 Locust SMG"
  recruit_success_legion:
    current_research:
      action: set
      string: "M80 Widow Rifle"
  recruit_success_mordin:
    current_research:
      action: set
      string: "M16 Carnifax Pistol"
  recruit_success_samara:
    current_research:
      action: set
      string: "Assault Rifle Damage"
  recruit_success_tali:
    current_research:
      action: set
      string: "Geth Plasma Shotgun"
  recruit_success_thane:
    current_research:
      action: set
      string: "M17 Viper Rifle"
  recruit_success_zaeed:
    current_research:
      action: set
      string: "Heavy Weapon Ammo"

shot_profiles:
  upgrade_shot_profile:
    show_when_disabled: False
    states:
      - name: lit
        show: flash

shots:
  collect_research_shot:
    hit_events: sh_right_ramp_hit
    enable_events:
      - mode_global_started{current_player.available_research>0 or current_player.available_shipupgrades>0}
      - player_available_research{change>0}
      - player_available_shipupgrades{change>0}
    disable_events:
      - collect_research_shot_hit
    profile: color_on
    show_tokens:
      leds: l_right_ramp_arrow_yellow
      color: FFFFFF

slide_player:
  research_completed:
    research_slide:
      expire: 3s
  shipupgrade_available:
    shipupgrade_ready_slide:
      expire: 7s  # Levelup slide is 4s, so this needs to be longer
  achievement_upgrade_armor_state_completed:
    upgrade_armor_complete_slide:
      expire: 1s
  achievement_upgrade_cannon_state_completed:
    upgrade_cannon_complete_slide:
      expire: 1s
  achievement_upgrade_shields_state_completed:
    upgrade_shields_complete_slide:
      expire: 1s

slides:
  research_slide:
    - type: text
      text: "Upgrade Researched"
      style: small
      anchor_x: left
      anchor_y: top
      x: 2
      y: top-2
    - type: text
      text: (player|current_research)
      style: medium
      anchor_y: top
      y: top-16
  shipupgrade_ready_slide:
    widgets:
      - type: text
        text: Ship Upgrade Available!
        style: medium
  upgrade_armor_complete_slide:
    widgets:
      - type: text
        text: Ship Upgrade Researched
        style: small
        anchor_y: bottom
        y: middle+6
      - type: text
        text: Silaris Armor
        style: text_default
        y: middle-4
  upgrade_cannon_complete_slide:
    widgets:
      - type: text
        text: Ship Upgrade Researched
        style: small
        anchor_y: bottom
        y: middle+6
      - type: text
        text: Thanix Cannon
        style: text_default
        y: middle-4
  upgrade_shields_complete_slide:
    widgets:
      - type: text
        text: Ship Upgrade Researched
        style: small
        anchor_y: bottom
        y: middle+6
      - type: text
        text: Multicore Shielding
        style: text_default
        y: middle-4

sound_player:
  collect_research_shot_hit: upgrade_collected_sound
  capture_shipupgrade_shot_hit: upgrade_collected_sound

sound_pools:
  upgrade_collected_sound:
    sounds: this_should_come_in_handy, we_can_use_this, this_might_be_useful, ill_take_it, this_is_valuable, this_looks_interesting, oh_whats_this
    type: random_force_all
    track: voice

sounds:
  this_should_come_in_handy:
    file: en_us_player_f_ss_global_player_female_00333977_f.ogg
    track: voice
    max_queue_time: 2s
  we_can_use_this:
    file: en_us_player_f_ss_global_player_female_00333980_f.ogg
    track: voice
    max_queue_time: 2s
  this_might_be_useful:
    file: en_us_player_f_ss_global_player_female_00333981_f.ogg
    track: voice
    max_queue_time: 2s
  ill_take_it:
    file: en_us_player_f_ss_global_player_female_00333984_f.ogg
    track: voice
    max_queue_time: 2s
  this_is_valuable:
    file: en_us_player_f_ss_global_player_female_00333989_f.ogg
    track: voice
    max_queue_time: 2s
  this_looks_interesting:
    file: en_us_player_f_ss_global_player_female_00333997_f.ogg
    track: voice
    max_queue_time: 2s
  oh_whats_this:
    file: en_us_player_f_ss_global_player_female_00333999_f.ogg
    track: voice
    max_queue_time: 2s

