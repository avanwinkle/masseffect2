#config_version=5

#####
# MISSION SELECT MODE
#
# This is a game logic mode to present a selection carousel to the player when
# missions are available for them to play. Usually this means any of the
# recruitment missions they've unlocked, but also Collecter Ship and the Suicide
# Mission will be present here.
#
# Due to the arbitrary nature of which missions are available, this mode uses
# a custom Python class (missionselect.py) to assess the state of each squadmate
# and dynamically populate the carousel items when the mode starts.
#####

mode:
  start_events: start_mode_missionselect
  stop_events: stop_mode_missionselect, missionselect_item_selected
  priority: 1000
  code: missionselect.MissionSelect
  file_log: full
  ##### Look into this:
  # Possible queue events:
  #   outgoing_balls_handler: balldevice_(name)_ball_eject_attempt
  #   mode: mode_(name)_starting, mode_(name)_stopping
  use_wait_queue: true


mode_settings:
  # All squadmates are included via missionselect.py, no need to list them here
  selectable_items: pass, suicide
  select_item_events: s_action_button_active
  next_item_events: s_flipper_right_active, missionselect_skip_forwards, mode_missionselect_started
  previous_item_events: s_flipper_left_active, missionselect_skip_backwards

event_player:
  mode_missionselect_started: flippers_off
  missionselect_item_selected: flippers_on

show_player:
  mode_missionselect_started: missionselect_show
  mode_missionselect_will_stop:
    missionselect_show:
      action: stop

shows:
  missionselect_show:
    - lights:
        gi: off

slide_player:
  missionselect_pass_highlighted:
    missionselect_intro_slide{current_player.missionselect_init==0}:
      action: play
    missionselect_pass_slide{current_player.missionselect_init!=0}:
      action: play
  missionselect_collectorship_highlighted: missionselect_collectorship_slide
  missionselect_suicide_highlighted: missionselect_suicide_slide
  # Recruitment Missions:
  missionselect_recruit_highlighted:
    missionselect_recruit_slide:
      action: play

slides:
  missionselect_intro_slide:
    priority: 100
    widgets:
      - type: text
        text: Select a Mission
        style: quadrit_big
        anchor_y: bottom
        y: bottom+45%
      - type: text
        text: < FLIPPERS >
        anchor_y: bottom
        style: dmd_small
        y: 3
  missionselect_recruit_slide:
    priority: 1
    widgets:
      - type: text
        text: (squadmate)
        style: quadrit_big
        anchor_y: bottom
        y: bottom+45%
        casing: title
      - type: text
        text: Start Recruitment Mission
        style: dmd_small
        anchor_y: bottom
        y: 3
  missionselect_collectorship_slide:
    priority: 1
    widgets:
      - type: text
        text: Disabled
        anchor_y: bottom
        y: 50%
      - type: text
        text: Collector Vessel
        anchor_y: top
        y: 50%
  missionselect_suicide_slide:
    priority: 1
    widgets:
      - type: text
        text: LAUNCH THE
        style: dmd_small
        bold: true
        anchor_y: top
        y: top-3
      - type: text
        text: SUICIDE MISSION
        font_size: 14
        style: quadrit_big
        anchor_y: bottom
        y: 3
  missionselect_pass_slide:
    priority: 10
    widgets:
      - type: text
        text: Pass for Now
        style: quadrit_big
        anchor_y: bottom
        y: bottom+45%

scoring:
  mode_missionselect_started:
    missionselect_init:
      action: set
      score: 0
  slide_missionselect_intro_slide_active:
    missionselect_init: 1
