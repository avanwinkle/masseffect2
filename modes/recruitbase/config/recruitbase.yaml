#config_version=5
mode:
  start_events:
    start_mode_recruitbase
  stop_events:
    stop_mode_recruitbase
  priority: 300

event_player:
  mode_recruitbase_started:
    - start_mode_recruitfield
  ball_hold_missionselect_hold_held_ball:
    - start_mode_missionselect
  start_mode_missionselect:
    - stop_mode_recruitfield
    - disable_nonrecruit_modes
  # If missions are available and we don't force the collector attack or derelict reaper:
  #enable_missionselector{device.achievements.collectorship.state!="enabled" and current_player.level!=9}:
  #  - start_mode_missionselect
  # After enough squadmates: collector ship
  #enable_missionselector{device.achievements.collectorship.state=="enabled"}:
  #  - start_mode_collectorship_base
  # At level 9: derelict reaper
  #enable_missionselector{current_player.level==9}:
  #  - start_mode_derelictreaper
  missionselect_pass_selected:
    - start_mode_recruitfield
    - start_mode_lockbypass
    - reenable_nonrecruit_modes
  missionselect_garrus_selected:
    - recruit_mission_starting
    - start_mode_recruitgarrus
  missionselect_grunt_selected:
    - recruit_mission_starting
    - start_mode_recruitgrunt
  missionselect_jack_selected:
    - recruit_mission_starting
    - start_mode_recruitjack
  missionselect_kasumi_selected:
    - recruit_mission_starting
    - start_mode_recruitkasumi
  missionselect_legion_selected:
    - recruit_mission_starting
    - start_mode_recruitlegion
  missionselect_mordin_selected:
    - recruit_mission_starting
    - start_mode_recruitmordin
  missionselect_samara_selected:
    - recruit_mission_starting
    - start_mode_recruitsamara
  missionselect_tali_selected:
    - recruit_mission_starting
    - start_mode_recruittali
  missionselect_thane_selected:
    - recruit_mission_starting
    - start_mode_recruitthane
  missionselect_zaeed_selected:
    - recruit_mission_starting
    - start_mode_recruitzaeed
  recruit_mission_starting:
    - disable_nonrecruit_modes
    - start_mode_lockbypass
    - stop_mode_missionselect
  recruit_mission_success:
    - levelup
  recruit_mission_ended:
    - start_mode_recruitfield
    - reenable_nonrecruit_modes
    - stop_mode_lockbypass
  start_mode_recruitfield{current_player.available_missions==0 and current_player.status_garrus!=2}:
    - start_mode_lockbypass
  player_status_garrus{value==2}:
    - stop_mode_lockbypass
  player_available_missions{value>0}:
    - stop_mode_lockbypass
    - enable_missionselector

ball_saves:
  debug_recruitmission_ballsave:
    active_time: 60s
    enable_events: recruit_mission_starting
    disable_events: recruit_mission_ended
    hurry_up_time: 10s
    early_ball_save_events: s_outlane_left_active, s_outlane_right_active
    balls_to_save: -1

ball_holds:
  missionselect_hold:
    balls_to_hold: 1
    hold_devices: bd_lock
    enable_events:
      enable_missionselector: 0
      start_mode_recruitfield{current_player.available_missions>0}: 0
    release_one_events: mode_missionselect_will_stop
    disable_events: mode_missionselect_stopping

# sound_player:
#   mode_recruitbase_started:
#     music_normandy_walkin_intro:
#       action: play
#       loops: -1
#       mode_end_action: stop


scoring:
  sw_standuptarget_active:
    score: 200
  recruit_advance{count==1}:
    recruits_lit_count: 1
    available_missions: 1
    score: 1000
  recruit_mission_success:
    score: 100000
    recruits_lit_count: -1
    squadmates_count: 1
    last_mission:
      string: "__recruitment__"
  recruit_garrus_complete: #recruit_mission_success{squadmate=="garrus"}:
    status_garrus:
      score: 0
      action: set
  recruit_grunt_complete: #recruit_mission_success{squadmate=="grunt"}:
    status_grunt:
      score: 0
      action: set
  recruit_jack_complete: #recruit_mission_success{squadmate=="jack"}:
    status_jack:
      score: 0
      action: set
  recruit_legion_complete: #recruit_mission_success{squadmate=="legion"}:
    status_legion:
      score: 0
      action: set
  recruit_mordin_complete: #recruit_mission_success{squadmate=="mordin"}:
    status_mordin:
      score: 0
      action: set
  recruit_samara_complete: #recruit_mission_success{squadmate=="samara"}:
    status_samara:
      score: 0
      action: set
  recruit_tali_complete: #recruit_mission_success{squadmate=="tali"}:
    status_tali:
      score: 0
      action: set
  recruit_thane_complete: #recruit_mission_success{squadmate=="thane"}:
    status_thane:
      score: 0
      action: set
  recruit_zaeed_complete: #recruit_mission_success{squadmate=="zaeed"}:
    status_zaeed:
      score: 0
      action: set
  set_last_recruit_garrus:
    last_recruit:
      string: "Garrus"
  set_last_recruit_grunt:
    last_recruit:
      string: "Grunt"
  set_last_recruit_jack:
    last_recruit:
      string: "Jack"
  set_last_recruit_kasumi:
    last_recruit:
      string: "Kasumi"
  set_last_recruit_legion:
    last_recruit:
      string: "Legion"
  set_last_recruit_mordin:
    last_recruit:
      string: "Mordin"
  set_last_recruit_samara:
    last_recruit:
      string: "Samara"
  set_last_recruit_tali:
    last_recruit:
      string: "Tali"
  set_last_recruit_thane:
    last_recruit:
      string: "Thane"
  set_last_recruit_zaeed:
    last_recruit:
      string: "Zaeed"

shot_profiles:
  recruit_profile:
    show_when_disabled: false
    advance_on_hit: false
    states:
      - name: unlit
        show: recruitshow_on
      - name: lit
        show: recruitshow_flash
      - name: recruited
        show: recruitshow_complete

# These shots need to exist in base so mission events will advance them
# even when the field mode is not running
shots:
  choose_mission_shot:
    switch: s_lock_3
    enable_events:
      start_mode_recruitfield{current_player.available_missions>0}: 0
    disable_events: recruit_mission_starting, achievement_collectorship_state_enabled
  collectorship_mission_shot:
    switch: s_lock_3
    enable_events: achievement_collectorship_state_enabled
  skip_mission_shot:
    switch: s_left_ramp_exit
    enable_events:
      start_mode_recruitfield{current_player.available_missions==0 and (current_player.status_garrus < 1 or current_player.status_garrus > 2)}: 0
      recruit_mission_starting: 0
    disable_events:
      start_mode_recruitfield{current_player.available_missions>0 or current_player.status_garrus == 2}: 0
      logicblock_recruit_garrus_counter_updated{value==2}: 0
  recruit_garrus_shot:
    switch: s_left_ramp_exit
    profile: recruit_profile
    advance_events: recruit_garrus_lit
    enable_events:
      enable_recruit_shots{current_player.status_garrus>0}: 0
    disable_events: disable_recruit_shots
    show_tokens:
      led: shot_shield_garrus
      lit: color_shield_blue
      color: 0E1B4F #color_garrus
    tags: recruit_shot
  recruit_grunt_shot:
    switch: s_left_orbit
    profile: recruit_profile
    advance_events: recruit_grunt_lit
    enable_events:
      enable_recruit_shots{current_player.status_grunt>0}: 0
    disable_events: disable_recruit_shots
    show_tokens:
      led: shot_shield_grunt
      lit: color_shield_orange
      color: EF521F #color_grunt
    tags: recruit_shot
  recruit_jack_shot:
    switch: s_kickback
    profile: recruit_profile
    advance_events: recruit_jack_lit
    enable_events:
      enable_recruit_shots{current_player.status_jack>0}: 0
    disable_events: disable_recruit_shots
    show_tokens:
      led: shot_shield_jack
      lit: color_shield_purple
      color: 7B3FB8 #color_jack
    tags: recruit_shot
  recruit_kasumi_shot:
    switch: s_right_ramp_exit
    profile: recruit_profile
    advance_events: recruit_kasumi_lit
    enable_events:
      enable_recruit_shots{current_player.status_kasumi>0}: 0
    disable_events: disable_recruit_shots
    show_tokens:
      led: shot_shield_kasumi
      lit: color_shield_yellow
      color: F7F315 #color_kasumi
    tags: recruit_shot
  recruit_legion_shot:
    switch: s_kickback
    profile: recruit_profile
    advance_events: recruit_legion_lit
    enable_events:
      enable_recruit_shots{current_player.status_jack<=0}: 0
    disable_events: disable_recruit_shots
    show_tokens:
      led: shot_shield_legion
      lit: color_shield_white
      color: white
    tags: recruit_shot
  recruit_mordin_shot:
    switch: s_right_orbit
    profile: recruit_profile
    advance_events: recruit_mordin_lit
    enable_events:
      enable_recruit_shots{current_player.status_mordin>0}: 0
    disable_events: disable_recruit_shots
    show_tokens:
      led: shot_shield_mordin
      lit: color_shield_red
      color: BD000A #color_mordin
    tags: recruit_shot
  recruit_samara_shot:
    switch: s_left_ramp_exit
    profile: recruit_profile
    advance_events: recruit_samara_lit
    enable_events:
      enable_recruit_shots{current_player.status_garrus<=0}: 0
    disable_events: disable_recruit_shots
    show_tokens:
      led: shot_shield_samara
      color: teal
    tags: recruit_shot
  recruit_tali_shot:
    switch: s_right_orbit
    profile: recruit_profile
    advance_events: recruit_tali_lit
    enable_events:
      enable_recruit_shots{current_player.status_mordin<=0}: 0
    disable_events: disable_recruit_shots
    show_tokens:
      led: shot_shield_tali
      color: pink
    tags: recruit_shot
  recruit_thane_shot:
    switch: s_right_ramp_exit
    profile: recruit_profile
    advance_events: recruit_thane_lit
    enable_events:
      enable_recruit_shots{current_player.status_kasumi<=0}: 0
    disable_events: disable_recruit_shots
    show_tokens:
      led: shot_shield_thane
      lit: color_shield_green
      color: green
    tags: recruit_shot
  recruit_zaeed_shot:
    switch: s_left_orbit
    profile: recruit_profile
    advance_events: recruit_zaeed_lit
    enable_events:
      enable_recruit_shots{current_player.status_grunt<=0}: 0
    disable_events: disable_recruit_shots
    show_tokens:
      led: shot_shield_zaeed
      color: red
    tags: recruit_shot


show_player:
  ball_save_debug_recruitmission_ballsave_timer_start:
    ball_save_show:
      action: play
      speed: 3
  ball_save_debug_recruitmission_ballsave_huryr_up:
    ball_save_show:
      action: play
      speed: 9
  ball_save_debug_recruitmission_ballsave_disabled:
    ball_save_show:
      action: stop

shows:
  recruitshow_off:
    - lights:
        (led): black
        (color): black
        (lit): black
  recruitshow_flash:
    - time: 0
      lights:
        (led): black
        (color): black
        (lit): white
    - time: +1
      lights:
        (led): black
        (color): black
        (lit): black
  recruitshow_on:
    - lights:
        (led): (color)
        (lit): black
  recruitshow_complete:
    - lights:
        (led): (color)
        (lit): white

slide_player:
  mode_recruitbase_started:
    recruiting_started_slide:
      expire: 2s

slides:
  recruiting_started_slide:
    widgets:
      - type: text
        text: Recruit Your Squad
        style: dmd_big


sound_player:
  recruit_garrus_complete: missioncomplete_voice_garrus
  recruit_mordin_complete: missioncomplete_voice_mordin

sound_pools:
  missioncomplete_voice_garrus:
    type: random
    track: voice
    sounds: missioncomplete_voice_garrus_1, missioncomplete_voice_garrus_2
    max_queue_time: 1s
  missioncomplete_voice_mordin:
    type: random
    track: voice
    sounds: missioncomplete_voice_mordin_1, missioncomplete_voice_mordin_2
    max_queue_time: 1s

sounds:
  missioncomplete_voice_garrus_1:
    file: en_us_hench_garrus_omggra_garrus_intro_d_00206434_m.ogg
    track: voice
    max_queue_time: 1s
  missioncomplete_voice_garrus_2:
    file: en_us_hench_garrus_omggra_2nd_intermission_d_00205620_m.ogg
    track: voice
    max_queue_time: 1s
  missioncomplete_voice_mordin_1:
    file: en_us_hench_professor_omgpra_mordin_d_00210601_m.ogg
    track: voice
    max_queue_time: 1s
  missioncomplete_voice_mordin_2:
    file: en_us_hench_professor_omgpra_mordin_d_00210653_m.ogg
    track: voice
    max_queue_time: 1s
