#config_version=5
mode:
  start_events: start_mode_shadowbroker
  stop_events: stop_mode_shadowbroker
  priority: 500

event_player:
  start_vasirchase_shot_lit_hit: start_mode_vasirchase

counters:
  sbvasir_counter:
    count_events: sbdroptarget_group_complete
    multiple_hit_window: 500ms # Not sure why sbdroptarget_group_complete{state:down} fires twice
    starting_count: 0
    count_complete_value: 3
    persist_state: true
    disable_on_complete: true
    reset_on_complete: false

scoring:
  sbdroptarget_group_complete:
    intel: 1

shot_groups:
  sbdroptarget_group:
    shots: sbdroptarget_bottom_shot, sbdroptarget_middle_shot, sbdroptarget_top_shot

shot_profiles:
  advance_sbdrops_profile:
    show_when_disabled: false
    states:
      - name: unlit
        show: sbdrops_off
      - name: one_lit
        show: sbdrops_one_show
      - name: two_lit
        show: sbdrops_two_show
      - name: three_lit
        show: sbdrops_three_show
  start_sbvasirchase_profile:
    show_when_disabled: false
    states:
      - name: lit
        show: light_sbvasirchase_show

shots:
  enabled_sbvasirchase_shot:
    hit_events: logicblock_sbvasir_counter_hit
    profile: advance_sbdrops_profile
  start_vasirchase_shot:
    switch: s_right_ramp_exit
    enable_events: logicblock_sbvasir_counter_complete
    disable_events: start_mode_vasirchase
    profile: start_sbvasirchase_profile
  sbdroptarget_bottom_shot:
    switch: s_dropbank_bottom
    reset_events: mode_shadowbroker_will_stop, sbdroptarget_group_complete
  sbdroptarget_middle_shot:
    switch: s_dropbank_middle
    reset_events: mode_shadowbroker_will_stop, sbdroptarget_group_complete
  sbdroptarget_top_shot:
    switch: s_dropbank_top
    reset_events: mode_shadowbroker_will_stop, sbdroptarget_group_complete

show_player:
  sbdroptarget_group_hit:
    sbdrops_flash:
      priority: 100
      loops: 6
      speed: 10
  sbdroptarget_group_complete:
    sbdrops_flash:
      priority: 100
      loops: 12
      speed: 10

shows:
  sbdrops_flash:
    - time: 0
      lights:
        l_dropbank_bottom: white
        l_dropbank_middle: white
        l_dropbank_top: white
    - time: '+1'
      lights:
        l_dropbank_bottom: black
        l_dropbank_middle: black
        l_dropbank_top: black
  sbdrops_off:
    - lights:
        l_dropbank_bottom: black
        l_dropbank_middle: black
        l_dropbank_top: black
  sbdrops_one_show:
    - lights:
        l_dropbank_bottom: white
        l_dropbank_middle: black
        l_dropbank_top: black
  sbdrops_two_show:
    - lights:
        l_dropbank_bottom: white
        l_dropbank_middle: white
        l_dropbank_top: black
  sbdrops_three_show:
    - lights:
        l_dropbank_bottom: white
        l_dropbank_middle: white
        l_dropbank_top: white
  light_sbvasirchase_show:
    - time: 0
      lights:
        l_dropbank_bottom: white
        l_dropbank_middle: white
        l_dropbank_top: white
        l_right_ramp_arrow_yellow: white
    - time: '+1'
      lights:
        l_right_ramp_arrow_yellow: black
