#config_version=5

#####
# LAIR OF THE SHADOW BROKER: HAGALAZ SHIP EXTERIOR
#
# This mode begins with all standup targets lit and a "shunt" program running on
# the kickback lane. Hitting a standup target lights the shots on either side,
# and hitting a lit shot progresses the shunt program's door-hack counter. When
# the counter is complete the door unlocks at the kickback lane; hitting the
# lane holds the ball and begins the Boss Combat mode.
#
# TODO: Scoring? The battering ram is a lightning conduit?
#
# Progress is not saved for this mode.
#####

mode:
  start_events: start_mode_shadowbroker_hagalaz
  stop_events: stop_mode_shadowbroker_hagalaz
  priority: 800

event_player:
  hagalaz_target1_hagalaz_profile_lit_hit:
    - enable_shunt_left_orbit
    - enable_shunt_kickback
  hagalaz_target2_hagalaz_profile_lit_hit:
    - enable_shunt_kickback
    - enable_shunt_left_ramp
  hagalaz_target3_hagalaz_profile_lit_hit:
    - enable_shunt_left_ramp
    - enable_shunt_right_ramp
  hagalaz_target4_hagalaz_profile_lit_hit:
    - enable_shunt_left_ramp
    - enable_shunt_right_ramp
  hagalaz_target5_hagalaz_profile_lit_hit:
    - enable_shunt_right_ramp
    - enable_shunt_right_orbit
  shunt_counter_complete: enable_final_shunt
  ball_hold_hagalaz_hold_held_ball: shadowbroker_hagalaz_complete

counters:
  shunt_counter:
    starting_count: 0
    count_complete_value: 3
    direction: up
    persist_state: false
    count_events: shunt_shot_shunt_profile_lit_hit

shot_groups:
  shunt_shot:
    shunt_left_orbit, shunt_right_orbit, shunt_left_ramp, shunt_right_ramp, shunt_kickback

shot_profiles:
  shunt_profile:
    show_when_disabled: false
    steps:
      - name: lit
        show: flash_color_show
        show_tokens:
          color: orange
  shunt_final_profile:
    show_when_disabled: false
    steps: 
      - name: lit
        show: flash_color_show
        show_tokens:
          color: green
  hagalaz_profile:
    steps:
      - name: lit
        show: flash
      - name: off
        show: off

shots:
  shunt_final_shot:
    hit_events: sh_kickback_hit
    enable_events: enable_final_shunt
    profile: shunt_final_profile
    show_tokens:
      leds: l_kickback_shield_rgb
  shunt_left_orbit:
    hit_events: sh_left_orbit_hit
    enable_events: enable_shunt_left_orbit
    disable_events: shunt_left_orbit_hit, enable_final_shunt
    profile: shunt_profile
    show_tokens:
      leds: l_left_orbit_shield_rgb
  shunt_left_ramp:
    hit_events: sh_left_ramp_hit
    enable_events: enable_shunt_left_ramp
    disable_events: shunt_left_ramp_hit, enable_final_shunt
    profile: shunt_profile
    show_tokens:
      leds: l_left_ramp_shield_rgb
  shunt_right_orbit:
    hit_events: sh_right_orbit_hit
    enable_events: enable_shunt_right_orbit
    disable_events: shunt_right_orbit_hit, enable_final_shunt
    profile: shunt_profile
    show_tokens:
      leds: l_right_orbit_shield_rgb
  shunt_right_ramp:
    hit_events: sh_right_ramp_hit
    enable_events: enable_shunt_right_ramp
    disable_events: shunt_right_ramp_hit, enable_final_shunt
    profile: shunt_profile
    show_tokens:
      leds: l_right_ramp_shield_rgb
  shunt_kickback:
    hit_events: sh_kickback_hit
    enable_events: enable_shunt_kickback
    disable_events: shunt_kickback_hit, enable_final_shunt
    profile: shunt_profile
    show_tokens:
      leds: l_kickback_shield_rgb
  shunt_left_ramp:
    hit_events: sh_left_ramp_hit
    enable_events: enable_shunt_left_ramp
    disable_events: shunt_left_ramp_hit, enable_final_shunt
    profile: shunt_profile
    show_tokens:
      leds: l_left_ramp_shield_rgb
  hagalaz_target1:
    switch: s_target1
    profile: hagalaz_profile
    show_tokens: 
      leds: l_standup_1
  hagalaz_target2:
    switch: s_target2
    profile: hagalaz_profile
    show_tokens: 
      leds: l_standup_2
  hagalaz_target3:
    switch: s_target3
    profile: hagalaz_profile
    show_tokens: 
      leds: l_standup_3
  hagalaz_target4:
    switch: s_target4
    profile: hagalaz_profile
    show_tokens: 
      leds: l_standup_4
  hagalaz_target5:
    switch: s_target5
    profile: hagalaz_profile
    show_tokens: 
      leds: l_standup_5
  