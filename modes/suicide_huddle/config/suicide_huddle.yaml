#config_version=5

mode:
  start_events: start_mode_suicide_huddle
  stop_events: stop_mode_suicide_huddle, suicide_huddle_complete
  events_when_started: flippers_off
  events_when_stopped: flippers_on
  priority: 3000
  use_wait_queue: true
  code: suicide_huddle.SuicideHuddle

mode_settings:
  selectable_items: intro
  select_item_events: s_action_button_active
  next_item_events: s_flipper_right_active
  previous_item_events: s_flipper_left_active

event_player:
  specialist_lw_callback_miranda:
    - play_specialist_lw_callback_miranda{current_player.status_miranda==4}|300ms
    - specialist_lw_callback_complete{current_player.status_miranda!=4}
  specialist_intro_complete: show_huddle_slide
  # If this is our first time coming to the mode, play a little ditty
  mode_suicide_huddle_started{current_player.suicide_continuing>0}:
    # With only infiltration and longwalk, we can use this easy condition. Adding more huddles will require more finesse
    - play_specialist_preselection_inf{device.achievements.infiltration.state!="completed"}
    - play_specialist_preselection_lw{device.achievements.infiltration.state=="completed"}
  # If we are repeating the mode, skip the ditty and go straight to selection
  mode_suicide_huddle_started{current_player.suicide_continuing==0}:
    - show_huddle_slide|3s

slide_player:
  show_huddle_slide:
    huddle_slide:
      action: play
  suicide_huddle_specialist_selected:
    huddle_slide:
      action: remove

slides:
  huddle_slide:
    widgets:
      - type: rectangle
        color: black
        width: 128
        height: 32
        z: 1
  specialist_inf_slide:
    widgets:
      - type: text
        text: "Specialist Selected:"
        style: small
        anchor_y: bottom
        y: middle+2
      - type: text
        text: (player|specialist)
        style: medium
        anchor_y: top
        y: middle-2
        casing: title

show_player:
  suicide_huddle_specialist_selected{mission=="infiltration"}:
    infiltration_starting_show:
      action: play
      loops: 0
  suicide_huddle_specialist_selected{mission=="longwalk"}:
    longwalk_starting_show:
      action: play
      loops: 0

shows:
  infiltration_starting_show:
    - time: 0
      sounds:
        infiltration_low:
          action: play
          track: music
    - time: 2.5s
      sounds:
        specialist_inf_intro:
          action: play
          track: voice
          events_when_stopped: suicide_huddle_complete
  longwalk_starting_show:
    - time: 0
      sounds:
        longwalk_low:
          action: play
          track: music
    - time: 1s
      sounds:
        specialist_lw_intro:
          action: play
          track: voice
          events_when_stopped: suicide_huddle_complete

sound_player:
  # Sounds in shows don't playback after loading, so pre-load them!
  mode_suicide_huddle_started:
    infiltration_low:
      action: load
      track: music
    specialist_inf_intro:
      action: load
      track: voice
    longwalk_low:
      action: load
      track: music
    specialist_lw_intro:
      action: load
      track: voice
  play_specialist_preselection_inf: specialist_preselection_inf
  play_specialist_preselection_lw: specialist_preselection_lw
  play_specialist_lw_no: specialist_lw_no
  play_specialist_lw_yes: specialist_lw_yes
  play_specialist_lw_callback_miranda: miranda_any_biotic_could

sound_pools:
  specialist_preselection_inf:
    track: voice
    type: random
    sounds:
      - shepard_some_could_sneak_in_this_shaft
      - jacob_who_do_we_send_into_the_shaft{current_player.status_jacob==4}
  specialist_preselection_lw:
    track: voice
    type: random
    sounds:
      - edi_chamber_overrun_with_seeker_swarms
      - shepard_what_about_biotics
      - shepard_conventional_weapons_useless
  specialist_lw_yes:
    track: voice
    type: random
    sounds:
      - specialist_biotic_field_yes_thane{current_player.status_thane==4}
      - specialist_biotic_field_yes_jacob{current_player.status_jacob==4}
      - specialist_biotic_field_yes_samara{current_player.status_samara==4}
      - specialist_biotic_field_yes_miranda{current_player.status_miranda==4}
      - specialist_biotic_field_yes_jack{current_player.status_jack==4}
  specialist_lw_no:
    track: voice
    type: random
    sounds:
      - specialist_biotic_field_no_thane{current_player.status_thane==4}
      - specialist_biotic_field_no_jacob{current_player.status_jacob==4}
      - specialist_biotic_field_no_samara{current_player.status_samara==4}
      - specialist_biotic_field_no_miranda{current_player.status_miranda==4}
      - specialist_biotic_field_no_jack{current_player.status_jack==4}
  specialist_inf_selection:
    track: voice
    sounds:
      - shep_selection_inf_garrus{current_player.specialist=="garrus"}
      - shep_selection_inf_jacob{current_player.specialist=="jacob"}
      - shep_selection_inf_kasumi{current_player.specialist=="kasumi"}
      - shep_selection_inf_legion{current_player.specialist=="legion"}
      - shep_selection_inf_mordin{current_player.specialist=="mordin"}
      - shep_selection_inf_tali{current_player.specialist=="tali"}
      - shep_selection_inf_thane{current_player.specialist=="thane"}
  specialist_inf_confirmation:
    track: voice
    sounds:
      - selection_inf_confirm_garrus{current_player.specialist=="garrus"}
      - selection_inf_confirm_jacob{current_player.specialist=="jacob"}
      - selection_inf_confirm_kasumi{current_player.specialist=="kasumi"}
      - selection_inf_confirm_legion{current_player.specialist=="legion"}
      - selection_inf_confirm_mordin{current_player.specialist=="mordin"}
      - selection_inf_confirm_tali{current_player.specialist=="tali"}
      - selection_inf_confirm_thane{current_player.specialist=="thane"}
  specialist_inf_intro:
    track: voice
    sounds:
      - specialist_inf_intro_garrus{current_player.specialist=="garrus"}
      - specialist_inf_intro_jacob{current_player.specialist=="jacob"}
      - specialist_inf_intro_kasumi{current_player.specialist=="kasumi"}
      - specialist_inf_intro_legion{current_player.specialist=="legion"}
      - specialist_inf_intro_mordin{current_player.specialist=="mordin"}
      - specialist_inf_intro_tali{current_player.specialist=="tali"}
      - specialist_inf_intro_thane{current_player.specialist=="thane"}
  specialist_lw_intro:
    track: voice
    sounds:
      - specialist_im_ready_samara{current_player.specialist=="samara"}
      - specialist_im_ready_jack{current_player.specialist=="jack"}
      - specialist_im_ready_jacob{current_player.specialist=="jacob"}
      - specialist_im_ready_miranda{current_player.specialist=="miranda"}
      - specialist_must_move_quickly_thane{current_player.specialist=="thane"}

sounds:
  # Huddles
  shepard_some_could_sneak_in_this_shaft:
    file: en_us_player_f_endgm1_huddle_01a_d_00317445_f.ogg
    track: voice
    events_when_stopped: specialist_intro_complete
  jacob_who_do_we_send_into_the_shaft:
    file: en_us_hench_leading_endgm1_huddle_01a_d_00257104_m.ogg
    track: voice
    events_when_stopped: specialist_intro_complete
  shepard_what_about_biotics:
    file: en_us_player_f_endgm2_huddle_02a_d_00282594_f.ogg
    track: voice
    events_when_stopped: play_specialist_lw_yes
  shepard_conventional_weapons_useless:
    file: en_us_player_f_endgm2_huddle_02a_d_00282560_f.ogg
    track: voice
    events_when_stopped: play_specialist_lw_no
  edi_chamber_overrun_with_seeker_swarms:
    file: en_us_hench_ai_endgm2_huddle_02a_d_00282512_m.ogg
    track: voice
    start_at: 1500ms
    events_when_stopped: play_specialist_lw_no
  miranda_any_biotic_could:
    file: en_us_hench_vixen_endgm2_huddle_02a_d_00282526_m.ogg
    track: voice
    events_when_stopped: specialist_intro_complete
  specialist_biotic_field_yes_thane:
    file: en_us_hench_assassin_endgm2_huddle_02a_d_00282695_m.ogg
    track: voice
    events_when_stopped: specialist_lw_callback_miranda
  specialist_biotic_field_no_thane:
    file: en_us_hench_assassin_endgm2_huddle_02a_d_00282698_m.ogg
    track: voice
    events_when_stopped: specialist_lw_callback_miranda
  specialist_biotic_field_yes_jack:
    file: en_us_hench_convict_endgm2_huddle_02a_d_00282515_m.ogg
    track: voice
    events_when_stopped: specialist_lw_callback_miranda
  specialist_biotic_field_no_jack:
    file: en_us_hench_convict_endgm2_huddle_02a_d_00282522_m.ogg
    track: voice
    events_when_stopped: specialist_lw_callback_miranda
  specialist_biotic_field_yes_jacob:
    file: en_us_hench_leading_endgm2_huddle_02a_d_00282516_m.ogg
    track: voice
    events_when_stopped: specialist_lw_callback_miranda
  specialist_biotic_field_no_jacob:
    file: en_us_hench_leading_endgm2_huddle_02a_d_00282524_m.ogg
    track: voice
    events_when_stopped: specialist_lw_callback_miranda
  specialist_biotic_field_yes_samara:
    file: en_us_hench_mystic_endgm2_huddle_02a_d_00282513_m.ogg
    track: voice
    events_when_stopped: specialist_lw_callback_miranda
  specialist_biotic_field_no_samara:
    file: en_us_hench_mystic_endgm2_huddle_02a_d_00282518_m.ogg
    track: voice
    events_when_stopped: specialist_lw_callback_miranda
  specialist_biotic_field_yes_miranda:
    file: en_us_hench_vixen_endgm2_huddle_02a_d_00282517_m.ogg
    track: voice
    events_when_stopped: specialist_intro_complete
  specialist_biotic_field_no_miranda:
    file: en_us_hench_vixen_endgm2_huddle_02a_d_00282527_m.ogg
    track: voice
    events_when_stopped: specialist_intro_complete
  # Confirmation for Long Walk
  specialist_im_ready_samara:
    file: en_us_hench_mystic_endgm2_huddle_03b_d_00267109_m.ogg
    track: voice
  specialist_im_ready_jack:
    file: en_us_hench_convict_endgm2_huddle_03b_d_00267114_m.ogg
    track: voice
  specialist_im_ready_jacob:
    file: en_us_hench_leading_endgm2_huddle_03b_d_00267107_m.ogg
    track: voice
  specialist_im_ready_miranda:
    file: en_us_hench_vixen_endgm2_huddle_03b_d_00267106_m.ogg
    track: voice
  specialist_must_move_quickly_thane:
    file: en_us_hench_assassin_endgm2_biotic_fail_c_00319752_m.ogg
    track: voice
  # Selection/confirmation for Infiltration
  specialist_inf_intro_thane:
    file: en_us_hench_assassin_endgm2_vent_update1_a_00258656_m.ogg
    track: voice
  specialist_inf_intro_garrus:
    file: en_us_hench_garrus_endgm2_vent_update1_a_00258654_m.ogg
    track: voice
  specialist_inf_intro_legion:
    file: en_us_hench_geth_endgm2_vent_update1_a_00258657_m.ogg
    track: voice
  specialist_inf_intro_jacob:
    file: en_us_hench_leading_endgm2_vent_update1_a_00258653_m.ogg
    track: voice
  specialist_inf_intro_mordin:
    file: en_us_hench_professor_endgm2_vent_update1_a_00258655_m.ogg
    track: voice
  specialist_inf_intro_tali:
    file: en_us_hench_tali_endgm2_vent_update1_a_00258658_m.ogg
    track: voice
  specialist_inf_intro_kasumi:
    file: en_us_hench_thief_endgm2_vent_update1_a_00258659_m.ogg
    track: voice
  shep_selection_inf_jacob:
    file: en_us_player_f_endgm1_huddle_01b_d_00258303_f.ogg
    track: voice
  shep_selection_inf_garrus:
    file: en_us_player_f_endgm1_huddle_01b_d_00258305_f.ogg
    track: voice
  shep_selection_inf_tali:
    file: en_us_player_f_endgm1_huddle_01b_d_00258306_f.ogg
    track: voice
  shep_selection_inf_legion:
    file: en_us_player_f_endgm1_huddle_01b_d_00258307_f.ogg
    track: voice
  shep_selection_inf_mordin:
    file: en_us_player_f_endgm1_huddle_01b_d_00258309_f.ogg
    track: voice
  shep_selection_inf_thane:
    file: en_us_player_f_endgm1_huddle_01b_d_00258310_f.ogg
    track: voice
  shep_selection_inf_kasumi:
    file: en_us_player_f_endgm1_huddle_01b_d_00258311_f.ogg
    track: voice
  selection_inf_confirm_thane:
    file: en_us_hench_assassin_endgm1_huddle_01b_d_00258292_m.ogg
    track: voice
  selection_inf_confirm_garrus:
    file: en_us_hench_garrus_endgm1_huddle_01b_d_00258282_m.ogg
    track: voice
  selection_inf_confirm_legion:
    file: en_us_hench_geth_endgm1_huddle_01b_d_00258286_m.ogg
    track: voice
  selection_inf_confirm_jacob:
    file: en_us_hench_leading_endgm1_huddle_01b_d_00258275_m.ogg
    track: voice
  selection_inf_confirm_mordin:
    file: en_us_hench_professor_endgm1_huddle_01b_d_00258290_m.ogg
    track: voice
  selection_inf_confirm_tali:
    file: en_us_hench_tali_endgm1_huddle_01b_d_00258284_m.ogg
    track: voice
  selection_inf_confirm_kasumi:
    file: en_us_hench_thief_endgm1_huddle_01b_d_00258294_m.ogg
    track: voice

widget_player:
  suicide_huddle_garrus_default:
    specialist_garrus_widget:
      action: update
      slide: huddle_slide
      widget_settings:
        style: spec_default
  suicide_huddle_garrus_highlighted:
    specialist_garrus_widget:
      action: update
      slide: huddle_slide
      widget_settings:
        style: spec_highlight
  suicide_huddle_garrus_dead:
    specialist_garrus_widget:
      action: update
      slide: huddle_slide
      widget_settings:
        style: spec_dead
  suicide_huddle_jack_default:
    specialist_jack_widget:
      action: update
      slide: huddle_slide
      widget_settings:
        style: spec_default
  suicide_huddle_jack_highlighted:
    specialist_jack_widget:
      action: update
      slide: huddle_slide
      widget_settings:
        style: spec_highlight
  suicide_huddle_jack_dead:
    specialist_jack_widget:
      action: update
      slide: huddle_slide
      widget_settings:
        style: spec_dead
  suicide_huddle_jacob_default:
    specialist_jacob_widget:
      action: update
      slide: huddle_slide
      widget_settings:
        style: spec_default
  suicide_huddle_jacob_highlighted:
    specialist_jacob_widget:
      action: update
      slide: huddle_slide
      widget_settings:
        style: spec_highlight
  suicide_huddle_jacob_dead:
    specialist_jacob_widget:
      action: update
      slide: huddle_slide
      widget_settings:
        style: spec_dead
  suicide_huddle_kasumi_default:
    specialist_kasumi_widget:
      action: update
      slide: huddle_slide
      widget_settings:
        style: spec_default
  suicide_huddle_kasumi_highlighted:
    specialist_kasumi_widget:
      action: update
      slide: huddle_slide
      widget_settings:
        style: spec_highlight
  suicide_huddle_kasumi_dead:
    specialist_kasumi_widget:
      action: update
      slide: huddle_slide
      widget_settings:
        style: spec_dead
  suicide_huddle_legion_default:
    specialist_legion_widget:
      action: update
      slide: huddle_slide
      widget_settings:
        style: spec_default
  suicide_huddle_legion_highlighted:
    specialist_legion_widget:
      action: update
      slide: huddle_slide
      widget_settings:
        style: spec_highlight
  suicide_huddle_legion_dead:
    specialist_legion_widget:
      action: update
      slide: huddle_slide
      widget_settings:
        style: spec_dead
  suicide_huddle_miranda_default:
    specialist_miranda_widget:
      action: update
      slide: huddle_slide
      widget_settings:
        style: spec_default
  suicide_huddle_miranda_highlighted:
    specialist_miranda_widget:
      action: update
      slide: huddle_slide
      widget_settings:
        style: spec_highlight
  suicide_huddle_miranda_dead:
    specialist_miranda_widget:
      action: update
      slide: huddle_slide
      widget_settings:
        style: spec_dead
  suicide_huddle_mordin_default:
    specialist_mordin_widget:
      action: update
      slide: huddle_slide
      widget_settings:
        style: spec_default
  suicide_huddle_mordin_highlighted:
    specialist_mordin_widget:
      action: update
      slide: huddle_slide
      widget_settings:
        style: spec_highlight
  suicide_huddle_mordin_dead:
    specialist_mordin_widget:
      action: update
      slide: huddle_slide
      widget_settings:
        style: spec_dead
  suicide_huddle_samara_default:
    specialist_samara_widget:
      action: update
      slide: huddle_slide
      widget_settings:
        style: spec_default
  suicide_huddle_samara_highlighted:
    specialist_samara_widget:
      action: update
      slide: huddle_slide
      widget_settings:
        style: spec_highlight
  suicide_huddle_samara_dead:
    specialist_samara_widget:
      action: update
      slide: huddle_slide
      widget_settings:
        style: spec_dead
  suicide_huddle_tali_default:
    specialist_tali_widget:
      action: update
      slide: huddle_slide
      widget_settings:
        style: spec_default
  suicide_huddle_tali_highlighted:
    specialist_tali_widget:
      action: update
      slide: huddle_slide
      widget_settings:
        style: spec_highlight
  suicide_huddle_tali_dead:
    specialist_tali_widget:
      action: update
      slide: huddle_slide
      widget_settings:
        style: spec_dead
  suicide_huddle_thane_default:
    specialist_thane_widget:
      action: update
      slide: huddle_slide
      widget_settings:
        style: spec_default
  suicide_huddle_thane_highlighted:
    specialist_thane_widget:
      action: update
      slide: huddle_slide
      widget_settings:
        style: spec_highlight
  suicide_huddle_thane_dead:
    specialist_thane_widget:
      action: update
      slide: huddle_slide
      widget_settings:
        style: spec_dead

widgets:
  specialist_garrus_widget:
    - type: text
      text: Garrus
      style: spec_dead
      y: 24
      x: 2
      z: 2
  specialist_jack_widget:
    - type: text
      text: Jack
      style: spec_dead
      y: 24
      x: 2
      z: 2
  specialist_jacob_widget:
    - type: text
      text: Jacob
      style: spec_dead
      y: 13
      x: 2
      z: 2
  specialist_kasumi_widget:
    - type: text
      text: Kasumi
      style: spec_dead
      y: 2
      x: 2
      z: 2
  specialist_legion_widget:
    - type: text
      text: Legion
      style: spec_dead
      y: 24
      x: 44
      z: 2
  specialist_miranda_widget:
    - type: text
      text: Miranda
      style: spec_dead
      y: 24
      x: 44
      z: 2
  specialist_mordin_widget:
    - type: text
      text: Mordin
      style: spec_dead
      y: 13
      x: 44
      z: 2
  specialist_samara_widget:
    - type: text
      text: Samara
      style: spec_dead
      y: 13
      x: 44
      z: 2
  specialist_tali_widget:
    - type: text
      text: Tali
      style: spec_dead
      y: 2
      x: 44
      z: 2
  specialist_thane_widget:
    - type: text
      text: Thane
      style: spec_dead
      y: 24
      x: 86
      z: 2
