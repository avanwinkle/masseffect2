#config_version=5

#####
# SUICIDE MISSION Pt. I: THE OMEGA 4 RELAY
#
# This mode is the first sub-mode of the Suicide Mission and is a fixed-time
# multiball with all shots lit.
#
# There are three conditions to end the mode: all lit shots are hit, the timer
# runs out, or all the balls drain. In all cases, this mode moves directly into
# Infiltration mode (i.e. it cannot be failed).
#####

mode:
  start_events: start_mode_suicide_omegarelay
  stop_events: ball_will_end, omegarelay_complete
  events_when_started: mode_type_suicide_started
  events_when_stopped: mode_type_suicide_stopped
  priority: 2300

event_player:
  # The mode ends if all the balls drain
  ball_save_omegarelay_save_saving_ball: omegarelay_complete
  # The mode ends if all the shots are hit
  omegarelay_shots_hit_complete: force_omega_end
  # The mode ends if the timer runs out
  timer_omegarelay_complete: force_omega_end
  # Force the end by disabling flippers and making the balls drain
  force_omega_end:
    - flippers_off

variable_player:
  mode_suicide_omegarelay_started:
    temp_hurryup_value:
      action: set
      int: 6000
    temp_multiplier:
      action: set
      float: 1.0
    temp_build_value:
      action: set
      int: 0
  omegarelay_shots_lit_hit:
    temp_hurryup_value:
      action: set
      int: 6000 * current_player.temp_multiplier
    score: current_player.temp_hurryup_value
    temp_build_value: current_player.temp_hurryup_value
    temp_multiplier:
      action: add
      float: 0.5
  omegarelay_shots_hit_complete:
    score: temp_build_value
  timer_omegarelay_tick:  # 6000 over 60s = 100 per second
    temp_hurryup_value: -100 * current_player.temp_multiplier

counters:
  omegarelay_extraball_counter:
    starting_count: 0
    count_complete_value: 6
    direction: up
    count_events: omegarelay_shots_lit_hit

multiballs:
  omegarelay:
    ball_count: 3
    ball_count_type: total
    ball_locks: bd_lock
    shoot_again: 10s
    start_events: mode_suicide_omegarelay_started

shot_groups:
  omegarelay_shots:
    shots: omg_left_orbit, omg_kickback, omg_left_ramp, omg_right_ramp, omg_right_orbit, omg_dropbank, omg_hitbank

shots:
  omg_left_ramp:
    hit_events: sh_left_ramp_hit
    profile: color_flashing_profile
    show_tokens:
      leds: l_left_ramp_shield_rgb
      color: FF2200 # color_collectors
  omg_left_orbit:
    hit_events: sh_left_orbit_hit
    profile: color_flashing_profile
    show_tokens:
      leds: l_left_orbit_shield_rgb
      color: FF2200 # color_collectors
  omg_right_ramp:
    hit_events: sh_right_ramp_hit
    profile: color_flashing_profile
    show_tokens:
      leds: l_right_ramp_shield_rgb
      color: FF2200 # color_collectors
  omg_right_orbit:
    hit_events: sh_right_orbit_hit
    profile: color_flashing_profile
    show_tokens:
      leds: l_right_orbit_shield_rgb
      color: FF2200 # color_collectors
  omg_kickback:
    hit_events: sh_kickback_hit
    profile: color_flashing_profile
    show_tokens:
      leds: l_kickback_shield_rgb
      color: FF2200 # color_collectors
  omg_dropbank:
    hit_events: sh_dropbank_top_hit, sh_dropbank_middle_hit, sh_dropbank_bottom_hit
    profile: color_flashing_profile
    show_tokens:
      leds: l_dropbank_shield_rgb
      color: FF2200 # color_collectors
  omg_hitbank:
    hit_events: sh_hitbank_top_hit, sh_hitbank_bottom_hit
    profile: color_flashing_profile
    show_tokens:
      leds: l_hitbank_shield_rgb
      color: FF2200 # color_collectors

sound_player:
  mode_suicide_omegarelay_started: omegarelay_gunsuccess
  # timer_omegarelay_tick{ticks==5}: joker_mass_effect_generators_offline
  force_omega_end: joker_everybody_hold_on

sounds:
  omegarelay_gunsuccess:
    file: mus_endgm1_gunsuccess.ogg
    track: music
    volume: 1
    mode_end_action: stop
  joker_mass_effect_generators_offline:
    file: en_us_hench_joker_endgm1_crash_landing_c_00311398_m.ogg
    track: voice
  joker_taking_evasive_manuevers:
    file: en_us_hench_joker_endgm1_dogfight_c_00278990_m.ogg
    track: voice
  joker_sitting_ducks_out_here:
    file: en_us_hench_joker_endgm1_enter_debris_field_a_00279538_m.ogg
    track: voice
  joker_how_do_you_like_that:
    file: en_us_hench_joker_endgm1_warship_c_00279811_m.ogg
    track: voice
  joker_everybody_hold_on:
    file: en_us_hench_joker_endgm1_warship_c_00279812_m.ogg
    track: voice
  shepard_get_in_close_finish_them_off:
    file: en_us_player_f_endgm1_warship_c_00279857_f.ogg
    track: voice

timers:
  omegarelay:
    start_value: 60
    end_value: 0
    direction: down
    tick_interval: 1s
    start_running: true
    control_events:
      - event: omegarelay_shots_hit_complete
        action: stop
      - event: force_omega_end
        action: stop
